<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Kushy Blog]]></title><description><![CDATA[The official blog for Kushy.net]]></description><link>http://blog.kushy.net/</link><generator>RSS for Node</generator><lastBuildDate>Thu, 19 Jul 2018 23:56:41 GMT</lastBuildDate><item><title><![CDATA[Kushy METRC PHP SDK]]></title><description><![CDATA[Keeping track of legal cannabis is one hell of a job. That's why many states that legalize medicinal and recreational cannabis license a 3rdâ€¦]]></description><link>http://blog.kushy.net//blog/2018/introducing-kushy-metrc-php-sdk/</link><guid isPermaLink="false">http://blog.kushy.net//blog/2018/introducing-kushy-metrc-php-sdk/</guid><pubDate>Thu, 19 Jul 2018 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Keeping track of legal cannabis is one hell of a job. That&apos;s why many states that legalize medicinal and recreational cannabis license a 3rd party seed to sale tracking solution to handle the sticky task. These solutions provide businesses a place to input their activity (plant growth, transfers, sales) so the state can monitor and ensure compliance with all regulations and restrictions. &lt;a href=&quot;http://metrc.com&quot;&gt;&lt;strong&gt;METRC&lt;/strong&gt;&lt;/a&gt; is one of these seed to sale tracking solutions currently licensed by 13 states. &lt;a href=&quot;http://kushy.net&quot;&gt;Kushy&lt;/a&gt; is certified with METRC to access their API, so that we can update seed to sale information on behalf of businesses. &lt;/p&gt;
&lt;p&gt;In order to make accessing the API easier for our developer, we put together an SDK for PHP programmers looking to quickly query METRC API endpoints. Our goal was to create a simple to use interface for the METRC API, without requiring the user manually input endpoints and whatnot. The result is a simple to use API for an API:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;../../../vendor/autoload.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;token package&quot;&gt;Kushy&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Metrc&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Routes&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Harvests&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$harvests&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Harvests&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;ca&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$vendorApiKey&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$userApiKey&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$harvests&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$metrc&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getActive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$licenseNumber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$startDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$endDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;The Construction&lt;/h2&gt;
&lt;p&gt;The SDK is a simple class that uses the Guzzle library to create HTTP requests on behalf of the user. Each endpoint &apos;route&apos; is a separate class that extends the base Guzzle class.&lt;/p&gt;
&lt;h2&gt;How to use it&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Install the METRC package with Composer: &lt;code class=&quot;language-text&quot;&gt;composer require &amp;#39;kushy/metrc-php-sdk&amp;#39;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Require whichever route class you need in your application - in this case we want to access the &lt;code class=&quot;language-text&quot;&gt;/harvests/&lt;/code&gt; endpoint (&lt;em&gt;assuming you&apos;re using PSR-4&lt;/em&gt;):&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require_once&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;../../../vendor/autoload.php&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;use&lt;/span&gt; &lt;span class=&quot;token package&quot;&gt;Kushy&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Metrc&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Routes&lt;span class=&quot;token punctuation&quot;&gt;\&lt;/span&gt;Harvests&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Create a new instance of the route class (&lt;code class=&quot;language-text&quot;&gt;Harvests&lt;/code&gt;) and pass through your state&apos;s abbreviated name (in this case &lt;code class=&quot;language-text&quot;&gt;ca&lt;/code&gt; for California) and Vendor + User API keys:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$harvests&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Harvests&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;ca&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$vendorApiKey&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$userApiKey&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Use one of the class methods to query the API - this example grabs the active harvests:&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$harvests&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$metrc&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getActive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$licenseNumber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$startDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$endDate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;You can find the package on &lt;a href=&quot;https://packagist.org/packages/kushy/metrc-php-sdk&quot;&gt;Packagist here&lt;/a&gt;, as well as a README with more details (instructions, tips and tricks, etc).&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Making cannabis (development) simpler&lt;/h2&gt;
&lt;p&gt;Here at Kushy we&apos;re always innovating and contributing back to the cannabis community to ensure that life gets easier for everyone in the cannabis chain of command -- from consumers to businesses to developers. If we can make it easier to integrate with METRC, it increases the potential for more excellent apps that keep businesses compliant and safe from losing their license.&lt;/p&gt;
&lt;p&gt;If you&apos;re interested in contributing and improving the SDK, &lt;a href=&quot;https://github.com/kushyapp/kushy-metrc-php-sdk&quot;&gt;fork us over on Github and send a PR our way!&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Stay kushy,
Oscar&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Keep Reading&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://packagist.org/packages/kushy/metrc-php-sdk&quot;&gt;kushy/metrc-php-sdk&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://metrc.com&quot;&gt;METRC&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://api-ca.metrc.com/Documentation/&quot;&gt;METRC API Docs for California&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Integrating Crowd Sourced Cannabis from Tumblr]]></title><description><![CDATA[How do you get pictures of over 9,000 cannabis strains? You could start a very long and expensive journey of buying and documentingâ€¦]]></description><link>http://blog.kushy.net//blog/2017/integrating-crowd-sourced-cannabis-from-tumblr/</link><guid isPermaLink="false">http://blog.kushy.net//blog/2017/integrating-crowd-sourced-cannabis-from-tumblr/</guid><pubDate>Sun, 10 Dec 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;How do you get pictures of over 9,000 cannabis strains? You could start a very long and expensive journey of buying and documenting thousands of products. Or you can get the community pitch in their pot (pics).&lt;/p&gt;
&lt;p&gt;When it came time to fill up the Kushy database with a myriad of dank images, we looked to WeedPornDaily, an online cannabis publication and community. Users of WPD can &lt;a href=&quot;http://weedporndaily.com/contribute&quot;&gt;submit photos to the website&lt;/a&gt; through a Tumblr submission form, or are curated by the staff from known stoney sources. With over 7 years of pot photos stockpiled and &lt;a href=&quot;http://weedporndaily.tumblr.com/tagged/blue-dream&quot;&gt;organized neatly by tag&lt;/a&gt;, we were able to effortlessly search through the archive and fill our database.&lt;/p&gt;
&lt;h2&gt;The Code&lt;/h2&gt;
&lt;p&gt;This was a pretty simple task. We take our database of over 9,000 cannabis strains and run it against the public Tumblr XML. Each strain name would be &lt;a href=&quot;http://weedporndaily.tumblr.com/tagged/blue-dream/xml&quot;&gt;checked as a Tumblr tag&lt;/a&gt;, and if we got photos, we&apos;d input it into an image database. The images would be associated with an &lt;code class=&quot;language-text&quot;&gt;item_id&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;item_type&lt;/code&gt;, where &lt;strong&gt;type&lt;/strong&gt; would be &lt;em&gt;strains&lt;/em&gt; and &lt;strong&gt;ID&lt;/strong&gt; would be the &lt;em&gt;Strain ID&lt;/em&gt;. And we&apos;d store the image caption, would contains additional credit for the image source.&lt;/p&gt;
&lt;p&gt;With PHP, this is accomplished fairly crudely using a combination of cURL and non-PDO SQL interactions:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot;&gt;
      &lt;pre class=&quot;language-php&quot;&gt;&lt;code class=&quot;language-php&quot;&gt;&lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;//mySQL&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// connect to mysql&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$servername&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;localhost&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$username&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$password&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;super_secret&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$dbname&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;kushy_api&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Create connection&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;mysqli&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$servername&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$username&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$password&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$dbname&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Check connection&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;connect_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;Connection failed: &quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;connect_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl_init&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token variable&quot;&gt;$timeout&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CURLOPT_URL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CURLOPT_RETURNTRANSFER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CURLOPT_CONNECTTIMEOUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$timeout&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;curl_setopt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;CURLOPT_USERAGENT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.13) Gecko/20080311 Firefox/2.0.0.13&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token variable&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;curl_exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token function&quot;&gt;curl_close&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$ch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Select all strains&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;SELECT * from strains&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$result&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Open log file&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$my_file&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;error-strains.txt&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$handle&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fopen&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$my_file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;w&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;die&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Cannot open file:  &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$my_file&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// If we got some strains&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;num_rows&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// loop through each sql result row&lt;/span&gt;
	&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$row&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$result&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;fetch_assoc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
	     &lt;span class=&quot;token comment&quot;&gt;// reset error handling&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$error&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$strain_id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;id&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$name&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$row&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;name&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;// pull API&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$url&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;http://weedporndaily.tumblr.com/tagged/&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$name&lt;/span&gt;&lt;/span&gt;/xml&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;$json_new&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;get_data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;// checks if Tumblr spit back a 400 Bad Request, or a real XML object&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token variable&quot;&gt;$object&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SimpleXmlElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$json_new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$e&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Do something with the exception, or ignore it.&lt;/span&gt;
            &lt;span class=&quot;token variable&quot;&gt;$error&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// log strains that don&apos;t have images&lt;/span&gt;
            &lt;span class=&quot;token variable&quot;&gt;$data&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;\n&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;token function&quot;&gt;fwrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$data&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        
        &lt;span class=&quot;token comment&quot;&gt;// if no error&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$error&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// make sure we have a post&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$object&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;post&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// loop through each post&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$object&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;posts&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;post&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$entry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;token comment&quot;&gt;// only proceed if we actually have a photo URL&lt;/span&gt;
                &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$entry&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;photo-url&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;token variable&quot;&gt;$photo&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$entry&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;photo-url&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token variable&quot;&gt;$caption&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;token variable&quot;&gt;$entry&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;photo-caption&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;&amp;lt;li&gt;&amp;lt;a href=&apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$photo&lt;/span&gt;&lt;/span&gt;&apos;&gt;&amp;lt;img src=&apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$photo&lt;/span&gt;&lt;/span&gt;&apos; width=&apos;100&apos; /&gt;&amp;lt;/a&gt;&amp;lt;/li&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;token comment&quot;&gt;// Insert into DB&lt;/span&gt;
                    &lt;span class=&quot;token variable&quot;&gt;$sql&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token double-quoted-string string&quot;&gt;&quot;INSERT INTO images ( item_id, item_type, image_url, caption )
                    VALUES (&apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$strain_id&lt;/span&gt;&lt;/span&gt;&apos;, &apos;strains&apos;, &apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$photo&lt;/span&gt;&lt;/span&gt;&apos;, &apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$caption&lt;/span&gt;&lt;/span&gt;&apos;)&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;token comment&quot;&gt;//check for errors - print in JS console&lt;/span&gt;
                    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$sql&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
                        console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token single-quoted-string string&quot;&gt;&apos;Success&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
                        &lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
                        console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;`Error &lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mysqli_error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$conn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token delimiter important&quot;&gt;?&gt;&lt;/span&gt;`&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;script&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
                        &lt;span class=&quot;token delimiter important&quot;&gt;&amp;lt;?php&lt;/span&gt;
                    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;fclose&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$handle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;We also create a log (&lt;code class=&quot;language-text&quot;&gt;error-strains.txt&lt;/code&gt;) of every strain that isn&apos;t represented on Tumblr, so we can double check and have a better understanding of where the holes are in the data.&lt;/p&gt;
&lt;h2&gt;The Result&lt;/h2&gt;
&lt;p&gt;After about 30 minutes of processing, we pulled over 3,000 photos for our 9,000+ strains. &lt;/p&gt;
&lt;p&gt;And that&apos;s only pulling the &lt;em&gt;first page&lt;/em&gt; of images for each strain that was picked up. Many strains have hundreds of pages of images, like &lt;a href=&quot;http://weedporndaily.tumblr.com/tagged/og-kush&quot;&gt;O.G. Kush&lt;/a&gt;, which would give us easily over 10k images alone. We&apos;ll save that scrape for another day.&lt;/p&gt;
&lt;p&gt;Thank you again to WeedPornDaily and it&apos;s community for providing the immense wealth of well sorted cannabis for us to parse and import into the &lt;a href=&quot;http://api.kushy.net&quot;&gt;Kushy API&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Oscar&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Keep Reading:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://weedporndaily.com&quot;&gt;WeedPornDaily&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.tumblr.com/docs/en/api/v1&quot;&gt;Tumblr API v1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://github.com/kushyapp&quot;&gt;Kushy Github&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[The Start of the Future]]></title><description><![CDATA[We're big fans of fast, responsive apps. There's nothing more discouraging than slugging around a website, waiting for each page to chugâ€¦]]></description><link>http://blog.kushy.net//blog/2017/the-start-of-the-future/</link><guid isPermaLink="false">http://blog.kushy.net//blog/2017/the-start-of-the-future/</guid><pubDate>Fri, 08 Dec 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;We&apos;re big fans of fast, responsive apps. There&apos;s nothing more discouraging than slugging around a website, waiting for each page to chug into place. Things should be reactive to our actions, and feel fairly seamless. The opposite of clunky.&lt;/p&gt;
&lt;p&gt;Here at Kushy, we&apos;ve done our best to develop a website full of all the features we need. The one thing we&apos;ve struggled with, is the &lt;strong&gt;user experience&lt;/strong&gt;. As good as our design is, we&apos;re inherently limited by our framework, which makes the site slower than we&apos;d prefer. &lt;/p&gt;
&lt;p&gt;Now we&apos;re hoping to shed our relationship with Wordpress and migrate our tech stack to a more efficient architecture.&lt;/p&gt;
&lt;h2&gt;Introducing new.kushy.net&lt;/h2&gt;
&lt;p&gt;This will be the home of our new developments with technology like React, Node, etc ðŸ‘‰ &lt;a href=&quot;http://new.kushy.net&quot;&gt;new.kushy.net&lt;/a&gt; ðŸ‘ˆ Test away! Let us know what you think about the look, feel, and functionality.&lt;/p&gt;
&lt;h3&gt;The New Tech Stack&lt;/h3&gt;
&lt;p&gt;The plan is to run a NodeJS/Express based API, which transmits our cannabis data to anyone. We&apos;ll have a React app on another NodeJS server that server side renders our app to ensure best SEO practices and improve UX. Businesses will have their own dashboard to connect to the API and manage their shops, inventory, etc -- this&apos;ll be created with PHP7 and jQuery for the highest level of compatibility and better safety than using heavy client-side scripts.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Business Dashboard &amp;#x3C;-- (Node API) -&gt; React&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Wordpress is slow&lt;/h2&gt;
&lt;p&gt;We&apos;re currently running Wordpress as our CMS, with a couple handfuls of plugins to transform Wordpress into a different beast. It can scale, but requires lots of tweaking and extra paid services (CDNs, cloud distribution, etc). And it &lt;em&gt;works&lt;/em&gt;, but requires custom written plugins. Which is almost &lt;em&gt;insulting&lt;/em&gt;, when the community touts the expansiveness of the plugin ecosystem, and most plugins are so poorly written they bog down your site (&lt;em&gt;or create immense security risks&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;Rather than rewriting the plugins, and dropping cash on CDNs, we opted to spend the development time engineering a new, custom codebase.&lt;/p&gt;
&lt;h2&gt;Don&apos;t You Have An API?&lt;/h2&gt;
&lt;p&gt;We first used the Wordpress API as the primary cannabis API. Then we migrated to the Directus API, which made the process faster and easier. Now we&apos;ve hit the wall with the current API, where we&apos;re requiring really custom endpoints that do specialized queries (lat/lng region mapping, complex JOINs, lots of good stuff). &lt;/p&gt;
&lt;p&gt;We could edit the Directus API to accomplish our goal, but we weren&apos;t a fan of codebase. And after minimal testing using Node and Express, it became clear it&apos;d be faster to write it from scratch -- our way.&lt;/p&gt;
&lt;h2&gt;Time to create the future&lt;/h2&gt;
&lt;p&gt;The future contains a lot of JavaScript.&lt;/p&gt;
&lt;h3&gt;NodeJS&lt;/h3&gt;
&lt;p&gt;We use Node for our server because of how lightweight and fast it is. It&apos;s also incredibly easy to cluster Node server, as well as break up Node apps into microservices to spread across the cloud. &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.linux.com/news/event/nodejs/2017/3/slaying-monoliths-netflix-nodejs&quot;&gt;We want to slay the monolith.&lt;/a&gt; &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It&apos;s time to end the era of a large application hosted on a single server. We&apos;ve been slowly weaned off the monolith by cloud-based services such as CDN, but there&apos;s no reason our application can&apos;t be created in a modular nature to operate independently.&lt;/p&gt;
&lt;h3&gt;ReactJS&lt;/h3&gt;
&lt;p&gt;You might be asking your why React?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Many sites are making the switch and seeing the performance and UX benefits.&lt;/li&gt;
&lt;li&gt;React is now MIT licensed, allowing for greater growth and adoption&lt;/li&gt;
&lt;li&gt;Even Wordpress is switching to React, from it&apos;s &lt;a href=&quot;https://github.com/Automattic/wp-calypso&quot;&gt;admin panel&lt;/a&gt; to theme creators using it on the frontend with the WP API.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We can argue about &lt;a href=&quot;https://medium.com/unicorn-supplies/angular-vs-react-vs-vue-a-2017-comparison-c5c52d620176&quot;&gt;Angular vs React vs Vue&lt;/a&gt;, but at the end of the day, the discussion is still surrounded around the adoption of Javascript based MVC frameworks. It&apos;s clear that React (or any technology we choose) may be an opinionated decision, but the competitive options are all within close enough margins that discounts any fear of refactoring.&lt;/p&gt;
&lt;p&gt;That&apos;s why we have our eyes on React. Not because it&apos;s a magic solution to the myriad of technical issues that create slow site speeds. We&apos;re looking at React because of how powerful the tiny library is, and the potential to scale.&lt;/p&gt;
&lt;p&gt;It&apos;s why companies like Airbnb and Netflix are using it, and giants like Yelp are migrating their complex codebase to it. React does an amazing job of managing the DOM in combination with state, making websites update minor details lightning fast without ever leaving the page.&lt;/p&gt;
&lt;h2&gt;What&apos;s left?&lt;/h2&gt;
&lt;p&gt;With &lt;a href=&quot;http://new.kushy.net&quot;&gt;New.Kushy&lt;/a&gt;, we created a rough test of React&apos;s potential. There&apos;s still a few key features missing from making full replacing our Wordpress site. User authentication, server side rendering, there&apos;s quite a few features we&apos;re looking forward to implement.&lt;/p&gt;
&lt;p&gt;Many of the present limitations on our new tech stack are based on our antiquated hosting platform. We&apos;re currently residing on server with pre-baked software that makes our job easier and harder at the same time. Things like Apache have been great for decades, but we&apos;re looking to making the switch to platforms like NGINX. &lt;/p&gt;
&lt;p&gt;Keep your eyes peeled! And let us know what you think &lt;a href=&quot;http://twitter.com/kushyapp&quot;&gt;on Twitter!&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Cheers!
Oscar&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Keep Reading&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://new.kushy.net&quot;&gt;The New Kushy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.linux.com/news/event/nodejs/2017/3/slaying-monoliths-netflix-nodejs&quot;&gt;Slaying the Monolith with Netflix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.freecodecamp.org/yes-react-is-taking-over-front-end-development-the-question-is-why-40837af8ab76&quot;&gt;Yes, React is taking over front-end development. The question is why.&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Kushy Blog is Alive!]]></title><description><![CDATA[After much deliberation over picking a cloud-based service like Medium or Tumblr, or even a Git-powered JAM-stack with  Jekyll  or  GatsbyJSâ€¦]]></description><link>http://blog.kushy.net//blog/2017/kushy-blog-is-alive/</link><guid isPermaLink="false">http://blog.kushy.net//blog/2017/kushy-blog-is-alive/</guid><pubDate>Wed, 06 Dec 2017 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;After much deliberation over picking a cloud-based service like Medium or Tumblr, or even a Git-powered JAM-stack with &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt; or &lt;a href=&quot;gatsbyjs.org&quot;&gt;GatsbyJS&lt;/a&gt;, we finally settled on a blog framework for Kushy: &lt;a href=&quot;https://getkirby.com/&quot;&gt;KirbyCMS&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;Don&apos;t get me wrong. We&apos;ll still post on &lt;a href=&quot;https://medium.com/kushyapp&quot;&gt;Medium&lt;/a&gt; and &lt;a href=&quot;https://kushyapp.tumblr.com/&quot;&gt;Tumblr&lt;/a&gt;. But we&apos;ll do the thing that brands like &lt;em&gt;Google Design&lt;/em&gt; does, and cross-post our content for maximum visibility.&lt;/p&gt;
&lt;h2&gt;Kirby the Pink Guy?&lt;/h2&gt;
&lt;div style=&apos;position:relative;padding-bottom:54%&apos;&gt;&lt;iframe src=&apos;https://gfycat.com/ifr/OblongBruisedKronosaurus&apos; frameborder=&apos;0&apos; scrolling=&apos;no&apos; width=&apos;100%&apos; height=&apos;100%&apos; style=&apos;position:absolute;top:0;left:0&apos; allowfullscreen&gt;&lt;/iframe&gt;&lt;/div&gt;
&lt;p&gt;Not &lt;em&gt;that&lt;/em&gt; Kirby. Kirby allows us to serve static content like a &lt;a href=&quot;https://gohugo.io/&quot;&gt;Hugo&lt;/a&gt;, but gives our writers the power of an admin panel to easily create content without activating &lt;em&gt;builds&lt;/em&gt; or &lt;em&gt;deploys&lt;/em&gt;. It&apos;s super fast, and very flexible. We can quickly create an API to serve content to our other apps. And when it comes time to migrate content, all of it is stored locally in a combination of YAML structuring (or &lt;em&gt;blueprints&lt;/em&gt;) and Markdown. &lt;/p&gt;
&lt;h2&gt;The Design&lt;/h2&gt;
&lt;p&gt;I whipped this up in Sketch over a night. Something simple, yet exemplifying the fundamental elements of our brand guide. It was easily adapted to Kirby thanks to their MVC style app structure. I created a couple core templates and a number of &lt;em&gt;&apos;snippets&apos;&lt;/em&gt; or components to include around the site (header, footer, navigation, etc).&lt;/p&gt;
&lt;h2&gt;The Structure&lt;/h2&gt;
&lt;p&gt;The goal of the blog was to have a home for Kushy&apos;s news and announcements, as well as a place for our development team to blog about their advancements. &lt;/p&gt;
&lt;p&gt;Rather than creating two separate blogs, or even sorting things out with categories (which gets confusing for both teams), we took advantage of Kirby&apos;s custom post types. Similar to Wordpress and &lt;a href=&quot;https://www.advancedcustomfields.com&quot;&gt;Advanced Custom Fields&lt;/a&gt;, you can create new types of posts with different meta data. So we&apos;d have a blog post type, and a dev post type -- each with differing fields, like their own set of categories.&lt;/p&gt;
&lt;p&gt;This allowed us to separate the content physically in different folders, as opposed to mixing posts in one giant blog folder. And it allowed users in the backend to easily find and author posts in either side of the site. Dev&apos;s have their blog, everyone else has theirs. Peace is hashed out in the blogroll.&lt;/p&gt;
&lt;h3&gt;The Team&lt;/h3&gt;
&lt;p&gt;Any of the cool cats working on Kushy are free to have an account on the blog. After an admin creates the initial user account, the user can login and fill out their author bio with their social media links. These are easily integrated with Kirby&apos;s blueprint system, allowing us to pull this data up on any post:&lt;/p&gt;
&lt;p&gt;(gist: &lt;a href=&quot;https://gist.github.com/kushyapp/1b0ff056a8f1e6f630740c83424f8219&quot;&gt;https://gist.github.com/kushyapp/1b0ff056a8f1e6f630740c83424f8219&lt;/a&gt;)&lt;/p&gt;
&lt;h2&gt;The Future&lt;/h2&gt;
&lt;p&gt;You never know. We could toss out this structure tomorrow in favor of a JAM stack. Ideally however, this is the best option for Kushy in terms of it&apos;s current growth trajectory. The blog is setup to horizontally scale on it&apos;s own separate distribution for a while.&lt;/p&gt;
&lt;p&gt;But &lt;strong&gt;things happen&lt;/strong&gt; and if we explode (&lt;em&gt;in terms of traffic&lt;/em&gt;), we&apos;ll need to integrate things like a CDN to store our images or a database to query for searches (ironic how static swings back to a database eventually at scale). And Kirby&apos;s admin panel is great, but it lacks some minor touches that would refine the UX (like autosaving posts occasionally so I don&apos;t get logged out and lose all my writing).&lt;/p&gt;
&lt;p&gt;We&apos;re also looking to integrate the Kushy API. Widgets for displaying strain profiles, or shop listings, or even an embeddable menu. We&apos;d like to make the connection between the blog and Kushy as seamless as possible thanks to the power of the API.&lt;/p&gt;
&lt;p&gt;Lots of cool stuff to look forward to!&lt;/p&gt;
&lt;p&gt;Oscar&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Further Reading:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://getkirby.com&quot;&gt;KirbyCMS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://api.kushy.net&quot;&gt;Kushy API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/kushyapp&quot;&gt;Kushy Medium&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://kushyapp.tumblr.com/&quot;&gt;Kushy Tumblr&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item></channel></rss>